<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADS FUND - Your Investment Partner</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Ensure html and body take at least full viewport height and allow scrolling */
        html, body {
            min-height: 100vh; /* Ensure it's at least the height of the viewport */
            height: auto; /* Allow content to push height beyond viewport if needed */
            overflow-x: hidden; /* Prevent horizontal scrolling */
        }
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth; /* Ensures smooth scrolling for anchor links */
            /* Subtle radial gradient background for the entire page */
            background-image: radial-gradient(circle at top left, #f0f8ff, #ffffff); /* Very light blue (aliceblue) to white */
            background-attachment: fixed;
        }

        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Countdown Timer */
        .countdown-timer {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fcd34d; /* yellow-300 */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* Modal specific styles (for planDetailModal, messageModal, signInModal, signUpModal, investModal, termsAndConditionsModal, investmentDetailsModal) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease-out, visibility 0.4s ease-out; /* Smoother transition */
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2.5rem;
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            max-width: 90%;
            width: 500px; /* Default width for most modals */
            position: relative;
            transform: translateY(-50px); /* Start further up */
            opacity: 0; /* Start invisible */
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.4s ease-out; /* Smoother easing */
            overflow-y: auto; /* Allow scrolling for taller modals */
            max-height: 90vh; /* Max height to fit within viewport */
        }
        /* Wider modal for investment form and terms */
        #investModal .modal-content,
        #signInModal .modal-content,
        #signUpModal .modal-content,
        #myInvestmentsModal .modal-content,
        #termsAndConditionsModal .modal-content,
        #investmentDetailsModal .modal-content,
        #whereMoneyWorksModal .modal-content { /* Added new detail modal and Where Your Money Works modal */
            width: 600px;
        }
        /* Specifically ensuring myInvestmentsModal content is plain white */
        #myInvestmentsModal .modal-content,
        #investmentDetailsModal .modal-content,
        #whereMoneyWorksModal .modal-content { /* Ensure plain white for detail modal too */
            background-color: white;
            background-image: none;
        }


        .modal-overlay.active .modal-content {
            transform: translateY(0); /* Slide down to original position */
            opacity: 1; /* Fade in */
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #4a5568; /* gray-700 */
            transition: color 0.2s ease-in-out;
        }
        .modal-close-btn:hover {
            color: #ef4444; /* red-500 */
            transform: rotate(90deg); /* Subtle rotate on close */
        }

        /* Common form styling within modals */
        .modal-content input[type="text"],
        .modal-content input[type="email"],
        .modal-content input[type="password"],
        .modal-content input[type="number"],
        .modal-content input[type="tel"],
        .modal-content select { /* Added select for consistent styling */
            width: calc(100% - 20px); /* Adjust for padding within the input */
            padding: 12px;
            margin: 10px 0;
            font-size: 1rem;
            border: 1px solid #cbd5e0; /* gray-300 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Smoother transition */
            color: #2d3748;
        }

        .modal-content input:focus,
        .modal-content select:focus { /* Added select focus */
            border-color: #3b82f6; /* blue-500 */
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25); /* blue-500 with alpha */
        }

        .modal-content label {
            display: block;
            text-align: left;
            width: calc(100% - 20px);
            margin-top: 10px;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2d3748;
        }

        .modal-content button {
            padding: 0.875rem 2rem; /* py-3 px-6 */
            margin-top: 1.5rem; /* Spacing from inputs */
            font-size: 1rem;
            font-weight: 600; /* semibold */
            border-radius: 9999px; /* rounded-full */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out; /* Consistent button transition */
            cursor: pointer;
            width: auto; /* Allow buttons to size naturally */
            display: inline-flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content button[type="submit"] {
            background-color: #3b82f6; /* blue-500 */
            color: white;
        }

        .modal-content button[type="submit"]:hover {
            background-color: #2563eb; /* blue-600 */
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .modal-content button[type="submit"]:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .modal-content .cancel-btn { /* Specific class for cancel buttons */
            background-color: #ef4444; /* red-500 */
            color: white;
            margin-left: 1rem; /* Spacing between buttons */
        }

        .modal-content .cancel-btn:hover {
            background-color: #dc2626; /* red-600 */
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .modal-content .cancel-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }


        /* Hero background image */
        .hero-background-image {
            background-image: url('https://wallpapercave.com/wp/wp13492660.png');
            background-size: cover; /* Cover the entire area */
            background-position: center; /* Center the image */
            background-repeat: no-repeat;
            position: absolute;
            inset: 0;
            z-index: 1; /* Below content, above glow */
        }

        /* Section reveal animation */
        .section-hidden {
            opacity: 0;
            transform: translateY(80px); /* Increased initial offset */
            transition: opacity 1.2s ease-out, transform 1.2s ease-out; /* Longer, smoother transition */
        }
        .section-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Gradient Text for headings */
        .gradient-text-blue {
            background: linear-gradient(to right, #1d4ed8, #3b82f6); /* blue-700 to blue-500 */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent; /* Fallback for browsers not supporting -webkit-text-fill-color */
        }

        /* Pulsating effect for main CTA button */
        @keyframes pulse-once {
            0% { transform: scale(1); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
            50% { transform: scale(1.03); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2), 0 10px 10px -5px rgba(0,0,0,0.04); }
            100% { transform: scale(1); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        }
        .cta-pulse {
            animation: pulse-once 2s ease-out; /* Run once on load, then can be repeated */
        }

        /* Enhanced card hover effects */
        .card-hover-effect:hover {
            transform: translateY(-8px) scale(1.02); /* Lift and slight scale */
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2), 0 10px 10px -5px rgba(0,0,0,0.04); /* Deeper shadow */
            border-color: var(--hover-border-color); /* Example: A slightly darker shade for purple */
        }

        /* Button hover/focus effects */
        .button-effect {
            transition: all 0.3s ease-in-out;
        }
        .button-effect:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        .button-effect:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Floating animation for icons/emojis */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        /* Hero section overlay glow (adjusted to work with dynamic background) */
        @keyframes hero-glow {
            0% { background-color: rgba(255, 255, 255, 0); }
            50% { background-color: rgba(255, 255, 255, 0.05); }
            100% { background-color: rgba(255, 255, 255, 0); }
        }
        .hero-overlay-glow {
            position: absolute;
            inset: 0;
            background-color: rgba(255, 255, 255, 0);
            animation: hero-glow 18s ease-in-out infinite alternate; /* Longer duration for subtler glow */
            z-index: 2; /* Ensure it's above the dynamic background */
        }

        /* Text stroke for Hero Section */
        .hero-text-stroke {
            text-shadow: 2px 2px 8px rgba(0,0,0,0.9), 0 0 10px rgba(0,0,0,0.5); /* Stronger black stroke/shadow */
        }

        .form-group {
            margin-bottom: 1.5rem; /* Increased spacing between form groups */
        }

        .form-input-field, .form-textarea-field {
            display: block;
            width: 100%;
            padding: 0.75rem 1rem; /* More padding */
            font-size: 1rem;
            line-height: 1.5;
            color: #4a5568; /* gray-700 */
            background-color: #f8fafc; /* light blue-gray */
            background-clip: padding-box;
            border: 1px solid #e2e8f0; /* gray-200 */
            border-radius: 0.75rem; /* rounded-lg */
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05); /* subtle inset shadow */
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Smoother transition */
        }

        .form-input-field:focus, .form-textarea-field:focus {
            color: #1a202c; /* dark gray */
            background-color: #fff;
            border-color: #3b82f6; /* blue-500 */
            outline: 0;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25); /* blue-500 with alpha */
        }

        .form-label {
            display: block;
            text-align: left;
            width: calc(100% - 20px);
            margin-top: 10px;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2d3748;
        }

        .form-submit-btn {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            font-weight: bold;
            padding: 0.875rem 2rem; /* py-3 px-6 */
            border-radius: 9999px; /* rounded-full */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .form-submit-btn:hover {
            background-color: #2563eb; /* blue-600 */
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .form-submit-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Fade animation for form messages */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(10px); }
        }

        .form-message-success, .form-message-error {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            text-align: center;
            font-weight: 500;
            animation: fadeIn 0.5s ease-out forwards; /* Fade in when displayed */
        }

        .form-message-success {
            background-color: #d1fae5; /* green-100 */
            color: #065f46; /* green-800 */
        }

        .form-message-error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
        }

        .form-message.fade-out {
            animation: fadeOut 0.5s ease-in forwards; /* Fade out when hidden */
        }

        /* Plan Card Specific Styles */
        .plan-card {
            position: relative;
            overflow: hidden;
            background-image: linear-gradient(to bottom right, #fdfdfd, #f0f0f0); /* Subtle light gradient */
            padding: 2rem; /* Adjusted from p-8 (2.5rem) to 2rem */
        }

        .plan-card.standard-plan {
            border-top: 8px solid #3b82f6; /* blue-500 */
            background-image: linear-gradient(to bottom right, #e0f7fa, #bbdefb); /* Light blue to a slightly darker blue */
        }

        .plan-card.premium-plan {
            border-top: 8px solid #8b5cf6; /* purple-500 */
            background-image: linear-gradient(to bottom right, #ede7f6, #d1c4e9); /* Light purple to a slightly darker purple */
        }

        .plan-card.elite-plan {
            border-top: 8px solid #f59e0b; /* yellow-500 */
            background-image: linear-gradient(to bottom right, #fffde7, #fff59d); /* Light yellow to a slightly darker yellow */
        }

        /* Enhanced hover effects for plan cards */
        .plan-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.3); /* Deeper shadow on hover */
            border-color: var(--hover-border-color); /* Dynamic border color */
        }
        .plan-card.standard-plan:hover { --hover-border-color: #1d4ed8; } /* darker blue */
        .plan-card.premium-plan:hover { --hover-border-color: #6d28d9; } /* darker purple */
        .plan-card.elite-plan:hover { --hover-border-color: #d97706; } /* darker yellow */

        /* Plan card icon styling */
        .plan-icon-wrapper {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            padding: 0.8rem; /* Slightly reduced padding */
            display: inline-flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 1rem; /* Reduced from 1.5rem to 1rem */
        }
        .plan-icon {
            font-size: 2.5rem; /* Slightly smaller icon size */
            line-height: 1;
        }

        /* New tag for plans */
        .plan-tag {
            position: absolute;
            top: 0.75rem; /* Adjusted from 1rem */
            right: 0.75rem; /* Adjusted from 1rem */
            background-color: #ef4444; /* red-500 */
            color: white;
            padding: 0.2rem 0.6rem; /* Slightly smaller padding */
            border-radius: 0.4rem; /* Slightly smaller border-radius */
            font-weight: bold;
            font-size: 0.8rem; /* Slightly smaller font size */
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            animation: pulse-tag 1.5s infinite ease-in-out alternate;
        }

        @keyframes pulse-tag {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Text adjustments for compactness */
        .plan-card h3 {
            margin-bottom: 0.75rem; /* Adjusted from 1rem */
        }
        .plan-card .text-lg.mb-4 {
            margin-bottom: 0.75rem; /* Adjusted from 1rem */
        }
        .plan-card .block.text-2xl.font-semibold.mb-2 {
            margin-bottom: 0.25rem; /* Adjusted from 0.5rem */
        }
        .plan-card .border-t.pt-4 {
            padding-top: 0.75rem; /* Adjusted from 1rem */
        }
        .plan-card h4.text-xl.mb-2 {
            margin-bottom: 0.5rem; /* Adjusted from 0.75rem */
        }

        /* New: Animation for plan cards when "Explore Our Plans" is clicked */
        @keyframes card-initial-pop {
            0% { transform: translateY(0) scale(1); opacity: 0.8; }
            25% { transform: translateY(-5px) scale(1.01); opacity: 1; }
            50% { transform: translateY(0) scale(1); opacity: 1; }
            75% { transform: translateY(-2px) scale(1.005); opacity: 1; }
            100% { transform: translateY(0) scale(1); opacity: 1; }
        }
        .animate-card-pop {
            animation: card-initial-pop 0.8s ease-out forwards; /* Run once, then stay */
        }

        /* Styles for "My Investments" summary cards within modal */
        .investment-summary-card {
            background-color: white;
            border-left: 8px solid; /* Color set dynamically */
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
        }

        .investment-summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .investment-summary-card .plan-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e3a8a;
        }
        .investment-summary-card .invest-date {
            font-size: 0.9rem;
            font-weight: 500;
            color: #6b7280;
            text-align: right;
        }
        .investment-summary-card .arrow-icon {
            font-size: 1.8rem;
            color: #3b82f6; /* blue-500 */
            margin-left: 1rem;
        }

        /* Specific border colors for investment summary cards */
        .investment-summary-card.standard-plan-item { border-color: #3b82f6; } /* blue-500 */
        .investment-summary-card.premium-plan-item { border-color: #8b5cf6; } /* purple-500 */
        .investment-summary-card.elite-plan-item { border-color: #f59e0b; } /* yellow-500 */


        /* Styles for Investment Details Modal content */
        .investment-details-group,
        .financial-details-group {
            margin-bottom: 1rem; /* Space between groups of details */
            padding: 0.75rem 1rem; /* Padding for the entire group */
            border-radius: 0.5rem;
            background-color: white; /* Changed to solid white */
            background-image: none; /* Ensure no gradient */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); /* Subtle shadow for the group */
        }

        .investment-details-group p,
        .financial-details-group p {
            display: flex; /* Keep flex for icon + text */
            align-items: center; /* Align items vertically in the center */
            padding: 0.25rem 0; /* Vertical padding for each line */
            border-bottom: 1px dashed rgba(0,0,0,0.1); /* Subtle dashed separator */
            font-size: 1.05rem; /* Slightly larger font for details */
            color: #374151; /* Default text color for details */
            flex-wrap: wrap; /* Allow content to wrap */
        }

        .investment-details-group p:last-child,
        .financial-details-group p:last-child {
            border-bottom: none; /* No border for the last item in a group */
        }

        .investment-details-group p span:first-child,
        .financial-details-group p span:first-child {
            font-weight: 500; /* Medium weight for labels */
            margin-right: 0.5rem; /* Small gap between label and value */
        }

        .investment-details-group p strong,
        .financial-details-group p strong {
            font-weight: 600; /* Semibold for values */
            color: #1a202c; /* Darker color for values for emphasis */
            word-break: break-word; /* Ensure long words break and wrap within the element */
            flex-basis: auto; /* Allow content to determine its width */
            flex-shrink: 0; /* Prevent shrinking too much */
        }

        /* Specific colors for financial values for quick identification */
        .investment-details-group .text-blue-700 { color: #1d4ed8; } /* Invested amount */
        .investment-details-group .text-green-700 { color: #047857; } /* Payouts and returns */
        .investment-details-group .text-gray-800 { color: #2d3748; } /* Dates, UTR, etc. */


        /* Style for UPI copy buttons */
        .copy-upi-btn {
            background-color: #28a745; /* Green */
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 0.5rem;
            font-size: 0.8rem;
            margin-left: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .copy-upi-btn:hover {
            background-color: #218838;
        }

        /* Terms and Conditions checkbox and link styling */
        .terms-checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            width: calc(100% - 20px); /* Match input width */
        }

        .terms-checkbox-group input[type="checkbox"] {
            margin-right: 0.75rem;
            transform: scale(1.2); /* Slightly larger checkbox */
            cursor: pointer;
        }

        .terms-checkbox-group label {
            display: inline-block;
            margin: 0; /* Override default label margin */
            font-weight: 500;
            color: #4a5568;
            cursor: pointer;
        }

        .terms-link {
            color: #3b82f6; /* blue-500 */
            text-decoration: underline;
            transition: color 0.2s ease;
        }

        .terms-link:hover {
            color: #2563eb; /* blue-600 */
        }
    </style>
</head>
<body>

    <!-- Header Section -->
    <header class="bg-gradient-to-r from-blue-700 to-indigo-800 text-white shadow-lg py-4 fixed w-full z-10">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <!-- Original SVG Logo - using a custom icon for "ADS FUND" -->
                <svg class="w-10 h-10 text-yellow-300" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <!-- A stylized 'A' for ADS with an upward arrow to represent growth -->
                    <path d="M12 2L2 22H5.5L12 8.3L18.5 22H22L12 2ZM12 5.6L14.7 11.2H9.3L12 5.6Z" fill="#ffeb3b"/>
                    <!-- A simple 'D' like shape for diversification/development -->
                    <path d="M19 12C19 15.866 15.866 19 12 19C8.13401 19 5 15.866 5 12C5 8.13401 8.13401 5 12 5H19V12ZM12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17C14.7614 17 17 14.7614 17 12H12V7Z" fill="#81c784"/>
                    <!-- A simple 'S' for security/stability -->
                    <path d="M17 6C14.7909 6 13 7.79086 13 10C13 12.2091 14.7909 14 17 14C19.2091 14 21 12.2091 21 10H17V6Z" fill="#ffa726"/>
                    <path d="M7 18C9.20914 18 11 16.2091 11 14C11 11.7909 9.20914 10 7 10C4.79086 10 3 11.7909 3 14H7V18Z" fill="#42a5f5"/>
                </svg>

                <a href="#" class="text-3xl font-bold tracking-tight">ADS FUND</a>
            </div>
            <nav class="hidden md:block">
                <ul class="flex space-x-8 text-lg font-medium">
                    <li><a href="#plans" class="hover:text-blue-200 transition duration-300">Investment Plans</a></li>
                    <li><a href="#how-it-works" class="hover:text-blue-200 transition duration-300">How It Works</a></li>
                    <li><a href="#why-choose-us" class="hover:text-blue-200 transition duration-300">Why Choose Us</a></li>
                    <li><a href="#" class="hover:text-blue-200 transition duration-300" id="whereMoneyWorksDesktopLink">Where Your Money Works</a></li> <!-- Updated href -->
                    <li><a href="#limited-time-offer" class="hover:text-blue-200 transition duration-300">Special Offer</a></li>
                    <li><a href="#ai-calculator" class="hover:text-blue-200 transition duration-300">AI Calculator</a></li>
                    <!-- Conditional Navigation based on Auth status -->
                    <li id="navAuthLinks" class="flex space-x-8">
                        <!-- Content managed by JavaScript -->
                    </li>
                </ul>
            </nav>
            <div class="md:hidden">
                <button id="mobileMenuButton" class="text-white focus:outline-none">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu Overlay -->
        <div id="mobileMenu" class="hidden md:hidden fixed inset-0 bg-blue-800 bg-opacity-95 z-50 flex flex-col items-center justify-center space-y-8 text-2xl font-bold transition-opacity duration-300 ease-in-out opacity-0">
            <button id="closeMobileMenuButton" class="absolute top-6 right-6 text-white text-4xl focus:outline-none">&times;</button>
            <ul class="flex flex-col items-center space-y-6">
                <li><a href="#plans" class="hover:text-yellow-300 transition duration-300" data-close-menu>Investment Plans</a></li>
                <li><a href="#how-it-works" class="hover:text-yellow-300 transition duration-300" data-close-menu>How It Works</a></li>
                <li><a href="#why-choose-us" class="hover:text-yellow-300 transition duration-300" data-close-menu>Why Choose Us</a></li>
                <li><a href="#" class="hover:text-yellow-300 transition duration-300" data-close-menu id="whereMoneyWorksMobileLink">Where Your Money Works</a></li> <!-- Updated href, new ID -->
                <li><a href="#limited-time-offer" class="hover:text-yellow-300 transition duration-300" data-close-menu>Special Offer</a></li>
                <li><a href="#ai-calculator" class="hover:text-yellow-300 transition duration-300" data-close-menu>AI Calculator</a></li>
                <!-- Conditional Mobile Nav Links -->
                <li id="mobileNavAuthLinks" class="flex flex-col items-center space-y-6">
                    <!-- Content managed by JavaScript -->
                </li>
            </ul>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="relative text-white flex items-center justify-center min-h-screen pt-24">
        <!-- New: Background image -->
        <div class="hero-background-image"></div>
        <div class="container mx-auto px-6 py-20 text-center relative z-10">
            <h1 class="text-5xl md:text-6xl font-extrabold leading-tight mb-6 hero-text-stroke">
                Welcome to <span class="text-yellow-300">ADS FUND</span>
            </h1>
            <p class="text-3xl md:text-4xl font-semibold mb-4 text-white hero-text-stroke">Aspire. Develop. Secure.</p>
            <p class="text-xl md:text-2xl mb-10 max-w-3xl mx-auto hero-text-stroke">
                Where your investments fuel growth and secure a prosperous financial future.
                We're dedicated to delivering consistent returns, fostering trust, and building long-term success together.
            </p>
            <a href="#plans" id="explorePlansBtn" class="bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105 inline-block cta-pulse button-effect">
                Explore Our Plans
            </a>
        </div>
    </section>

    <!-- Investment Plans Section -->
    <section id="plans" class="py-20 bg-gray-100 section-hidden">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-extrabold text-center mb-12 gradient-text-blue">Our Investment Plans</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">

                <!-- Standard Plan Card -->
                <div class="plan-card standard-plan bg-white rounded-3xl shadow-xl transform transition duration-300 hover:scale-105 flex flex-col cursor-pointer card-hover-effect"
                    data-plan-name="Standard Plan"
                    data-monthly-return="6%"
                    data-min-investment="500"
                    data-payout-frequency="Monthly"
                    data-lock-in="2 months minimum"
                    data-benefits='["Stable 6% return on investment every month.", "Flexible withdrawal option after the lock-in period."]'
                    data-total-return="12% over 2 months">
                    <span class="plan-tag">NEW</span>
                    <div class="plan-icon-wrapper mx-auto mb-4">
                        <span class="plan-icon text-blue-600">🛡️</span>
                    </div>
                    <h3 class="text-3xl font-bold text-blue-700 mb-3 text-center">Standard Plan</h3>
                    <p class="text-lg mb-3 text-center">
                        <span class="block text-2xl font-semibold text-green-600 mb-1">6% Monthly Return</span>
                        Minimum Investment: <span class="font-bold">₹500</span><br>
                        Payout Frequency: Monthly<br>
                        Lock-in Period: 2 months minimum
                    </p>
                    <div class="border-t border-gray-200 pt-3 mt-auto">
                        <h4 class="text-xl font-semibold text-gray-700 mb-2">Benefits:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Stable 6% return on investment every month.</li>
                            <li>Flexible withdrawal option after the lock-in period.</li>
                        </ul>
                    </div>
                </div>

                <!-- Premium 6-Month Plan Card -->
                <div class="plan-card premium-plan bg-white rounded-3xl shadow-xl transform transition duration-300 hover:scale-105 flex flex-col cursor-pointer card-hover-effect"
                    data-plan-name="Premium 6-Month Plan"
                    data-monthly-return="6.75%"
                    data-min-investment="500"
                    data-payout-frequency="Monthly"
                    data-lock-in="6 months"
                    data-benefits='["Bonus: Receive an additional 4.5% return at the end of the 6-month period.", "Total Return: 45% over 6 months (40.5% from monthly returns + 4.5% bonus).", "Perk: Priority Support.", "Referral Bonus: Refer another investor and earn an extra 1% on your referrals investment."]'
                    data-total-return="45% over 6 months">
                     <div class="plan-icon-wrapper mx-auto mb-4">
                        <span class="plan-icon text-purple-600">⭐</span>
                    </div>
                    <h3 class="text-3xl font-bold text-purple-700 mb-3 text-center">Premium 6-Month Plan</h3>
                    <p class="text-lg mb-3 text-center">
                        <span class="block text-2xl font-semibold text-green-600 mb-1">6.75% Monthly Return</span>
                        Minimum Investment: <span class="font-bold">₹500</span><br>
                        Payout Frequency: Monthly<br>
                        Lock-in Period: 6 months
                    </p>
                    <div class="border-t border-gray-200 pt-3 mt-auto">
                        <h4 class="text-xl font-semibold text-gray-700 mb-2">SPECIAL OFFER:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Bonus: Receive an additional <span class="font-bold">4.5% return</span> at the end of the 6-month period.</li>
                            <li>Total Return: <span class="font-bold">45% over 6 months</span> (40.5% from monthly returns + 4.5% bonus).</li>
                        </ul>
                        <h4 class="text-xl font-semibold text-gray-700 mb-2 mt-4">Exclusive Perks:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Priority Support.</li>
                            <li>Referral Bonus: Refer another investor and earn an extra <span class="font-bold">1%</span> on your referrals investment.</li>
                        </ul>
                    </div>
                </div>

                <!-- Elite 12-Month Plan Card -->
                <div class="plan-card elite-plan bg-white rounded-3xl shadow-xl transform transition duration-300 hover:scale-105 flex flex-col cursor-pointer card-hover-effect"
                    data-plan-name="Elite 12-Month Plan"
                    data-monthly-return="7.5%"
                    data-min-investment="1000"
                    data-payout-frequency="Monthly"
                    data-lock-in="12 months"
                    data-benefits='["Bonus: Receive an additional 10% return at the end of the 12-month period.", "Total Return: 100% over 12 months (90% from monthly returns + 10% bonus).", "Referral Bonus: Refer another investor and earn an extra 2% on your referrals investment.", "Annual Investment Report: Get a comprehensive analysis of your returns and market trends."]'
                    data-total-return="100% over 12 months">
                    <div class="plan-icon-wrapper mx-auto mb-4">
                        <span class="plan-icon text-yellow-600">👑</span>
                    </div>
                    <h3 class="text-3xl font-bold text-yellow-700 mb-3 text-center">Elite 12-Month Plan</h3>
                    <p class="text-lg mb-3 text-center">
                        <span class="block text-2xl font-semibold text-green-600 mb-1">7.5% Monthly Return</span>
                        Minimum Investment: <span class="font-bold">₹1000</span><br>
                        Payout Frequency: Monthly<br>
                        Lock-in Period: 12 months
                    </p>
                    <div class="border-t border-gray-200 pt-3 mt-auto">
                        <h4 class="text-xl font-semibold text-gray-700 mb-2">SPECIAL OFFER:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Bonus: Receive an additional <span class="font-bold">10% return</span> at the end of the 12-month period.</li>
                            <li>Total Return: <span class="font-bold">100% over 12 months</span> (90% from monthly returns + 10% bonus).</li>
                        </ul>
                        <h4 class="text-xl font-semibold text-gray-700 mb-2 mt-4">Exclusive Perks:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Referral Bonus: Refer another investor and earn an extra <span class="font-bold">2%</span> on your referrals investment.</li>
                            <li>Annual Investment Report: Get a comprehensive analysis of your returns and market trends.</li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works" class="py-20 bg-blue-700 text-white section-hidden">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl font-extrabold mb-12">How It Works</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <div class="bg-blue-600 rounded-2xl p-8 shadow-lg transform transition duration-300 hover:scale-105 hover:bg-blue-500">
                    <div class="text-5xl mb-4 float-animation">💰</div>
                    <h3 class="text-2xl font-bold mb-3">Consistent Monthly Payments</h3>
                    <p class="text-lg">Investors receive <span class="font-bold">competitive returns as per their chosen plan</span> on their principal investment every month, <span class="font-bold text-yellow-200">disbursed at the end of each calendar month,</span> reliably and on time.</p>
                </div>
                <div class="bg-blue-600 rounded-2xl p-8 shadow-lg transform transition duration-300 hover:scale-105 hover:bg-blue-500">
                    <div class="text-5xl mb-4 float-animation">🎁</div>
                    <h3 class="text-2xl font-bold mb-3">Bonus Offers</h3>
                    <p class="text-lg">Investors opting for <span class="font-bold">6-month or 12-month plans</span> are rewarded with an additional percentage at the end of their term as a loyalty bonus.</p>
                </div>
                <div class="bg-blue-600 rounded-2xl p-8 shadow-lg transform transition duration-300 hover:scale-105 hover:bg-blue-500">
                    <div class="text-5xl mb-4 float-animation">💸</div>
                    <h3 class="text-2xl font-bold mb-3">Flexible Withdrawals</h3>
                    <p class="text-lg">After the lock-in period, investors may choose to <span class="font-bold">withdraw their principal investment and any accumulated bonuses,</span> reinvest, or continue receiving monthly returns. <span class="font-bold text-yellow-200">For early withdrawals (before lock-in ends), the principal amount will be returned after 15 days, with a deduction equivalent to 2 months' returns.</span></p>
                </div>
            </div>
        </div>
    </section>

    <!-- Why Choose Us Section -->
    <section id="why-choose-us" class="py-20 bg-gray-50 section-hidden">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl font-extrabold text-center mb-12 gradient-text-blue">Why Choose ADS FUND?</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <div class="bg-white rounded-2xl p-8 shadow-xl transform transition duration-300 hover:scale-105 border-b-4 border-green-500 text-center">
                    <div class="text-5xl text-green-600 mb-4 float-animation">📈</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-3">High Returns</h3>
                    <p class="text-lg text-gray-700">We offer industry-leading returns with guaranteed monthly payouts, maximizing your investment growth.</p>
                </div>
                <div class="bg-white rounded-2xl p-8 shadow-xl transform transition duration-300 hover:scale-105 border-b-4 border-orange-500 text-center">
                    <div class="text-5xl text-orange-600 mb-4 float-animation">⭐</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-3">Special Offers</h3>
                    <p class="text-lg text-gray-700">Maximize your profits with our exclusive 6-month and 12-month bonuses, rewarding your loyalty.</p>
                </div>
                <div class="bg-white rounded-2xl p-8 shadow-xl transform transition duration-300 hover:scale-105 border-b-4 border-teal-500 text-center">
                    <div class="text-5xl text-teal-600 mb-4 float-animation">🔒</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-3">Security & Trust</h3>
                    <p class="text-lg text-gray-700">Your investment is protected with transparent terms and a dedicated support team, ensuring peace of mind.</p>
                </div>
            </div>
            <p class="text-center text-xl text-gray-700 mt-12 max-w-3xl mx-auto">
                This structure encourages longer-term investments by offering additional bonuses, while also giving flexibility to those interested in shorter-term gains.
            </p>
        </div>
    </section>

    <!-- Limited Time Offer Section -->
    <section id="limited-time-offer" class="py-20 bg-gradient-to-r from-red-600 to-red-800 text-white text-center animate-pulse-light section-hidden">
        <div class="container mx-auto px-6">
            <h2 class="text-5xl font-extrabold mb-6">🔥 Limited Time Offer! 🔥</h2>
            <p class="text-2xl mb-8 max-w-2xl mx-auto">
                Invest in our Premium 6-Month Plan this month and receive an **additional 2% bonus** at the end of your term!
                That's a total of <span class="font-bold text-yellow-300">7% bonus</span> for just 6 months!
            </p>
            <div class="countdown-timer mb-8" id="countdown"></div>
            <a href="#plans" class="bg-yellow-400 hover:bg-yellow-500 text-red-900 font-bold py-3 px-10 rounded-full shadow-lg transform transition duration-300 hover:scale-105 inline-block text-xl">
                Seize This Opportunity!
            </a>
        </div>
    </section>

    <!-- Investment Calculator Section -->
    <section id="ai-calculator" class="py-20 bg-gradient-to-br from-blue-700 to-indigo-800 text-white section-hidden">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl font-extrabold mb-12">Calculate Your Returns</h2>
            <div class="bg-blue-600 rounded-2xl p-8 shadow-xl max-w-xl mx-auto">
                <div class="mb-6 text-left">
                    <label for="investmentAmount" class="block text-xl font-medium mb-2">Investment Amount (₹):</label>
                    <input type="number" id="investmentAmount" value="1000" min="0" step="100" class="w-full p-3 rounded-lg bg-blue-700 border border-blue-500 text-white placeholder-blue-300 focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition duration-200" placeholder="e.g., 500, 1000">
                </div>
                <div class="mb-8 text-left">
                    <label for="investmentPlan" class="block text-xl font-medium mb-2">Select Investment Plan:</label>
                    <select id="investmentPlan" class="w-full p-3 rounded-lg bg-blue-700 border border-blue-500 text-white focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition duration-200">
                        <option value="standard">Standard Plan (2+ months)</option>
                        <option value="premium">Premium 6-Month Plan</option>
                        <option value="elite">Elite 12-Month Plan</option>
                    </select>
                </div>
                <button id="calculateBtn" class="bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-bold py-3 px-8 rounded-full shadow-lg transform transition duration-300 hover:scale-105 inline-flex items-center justify-center">
                    Calculate Returns
                </button>

                <div id="results" class="mt-10 text-left bg-blue-700 p-6 rounded-lg hidden">
                    <h3 class="text-2xl font-bold mb-4 text-yellow-300">Projected Returns:</h3>
                    <p class="text-xl mb-4">Initial Investment: <span id="displayInitialInvestment" class="font-semibold">₹0</span></p>
                    <p class="text-xl mb-4">Projected Total Return: <span id="displayTotalReturn" class="font-semibold">₹0</span></p>
                    <p class="text-xl mb-4">Total Percentage Return: <span id="displayPercentageReturn" class="font-semibold">0%</span></p>
                </div>
                <div id="errorMessage" class="mt-6 text-red-300 text-lg hidden">
                    An error occurred. Please try again later.
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center text-gray-400">
            <p>&copy; 2024 ADS FUND. All rights reserved.</p>
            <p class="mt-2">For inquiries, please contact us at <a href="mailto:itsads2k23@gmail.com" class="text-blue-400 hover:underline">itsads2k23@gmail.com</a></p>
        </div>
    </footer  >

    <!-- Investment Plan Detail Modal -->
    <div id="planDetailModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closePlanDetailModalBtn">&times;</button>
            <h3 id="modalPlanName" class="text-3xl font-bold text-blue-700 mb-4"></h3>
            <p class="text-lg mb-2"><strong>Monthly Return:</strong> <span id="modalMonthlyReturn"></span></p>
            <p class="text-lg mb-2"><strong>Minimum Investment:</strong> ₹<span id="modalMinInvestment"></span></p>
            <p class="text-lg mb-2"><strong>Payout Frequency:</strong> <span id="modalPayoutFrequency"></span></p>
            <p class="text-lg mb-4"><strong>Lock-in Period:</strong> <span id="modalLockIn"></span></p>
            <p class="text-lg mb-4"><strong>Total Projected Return:</strong> <span id="modalTotalReturn"></span></p>
            <h4 class="text-xl font-semibold text-gray-700 mb-2">Key Highlights:</h4>
            <ul id="modalBenefits" class="list-disc list-inside text-gray-600 space-y-1 mb-6">
                <!-- Benefits will be populated here -->
            </ul>

            <button id="investNowBtn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-md transform transition duration-300 hover:scale-105">
                Invest Now!
            </button>
        </div>
    </div>

    <!-- Investment Form Modal (repurposed from #investForm) -->
    <div id="investModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeInvestModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">Invest in <span id="investFormPlanName"></span></h2>
            <form id="investmentForm" class="flex flex-col items-center">
                <!-- UPI IDs Section -->
                <div class="w-full mb-6 text-center bg-gray-100 p-4 rounded-lg shadow-inner">
                    <p class="text-lg font-semibold text-gray-800 mb-3">Please make your payment to one of the UPI IDs below:</p>
                    
                    <div class="flex items-center justify-center mb-3">
                        <span id="upiId1" class="font-mono text-blue-700 text-lg break-all">chowdhurybarnadip98-1@okicici</span>
                        <button type="button" class="copy-upi-btn" data-upi="chowdhurybarnadip98-1@okicici">Copy</button>
                    </div>
                    <div class="flex items-center justify-center">
                        <span id="upiId2" class="font-mono text-blue-700 text-lg break-all">subhabubai1234-5@okicici</span>
                        <button type="button" class="copy-upi-btn" data-upi="subhabubai1234-5@okicici">Copy</button>
                    </div>
                </div>

                <label for="inv_name" class="w-full">Your Name:</label>
                <input type="text" id="inv_name" placeholder="Your Name" required class="w-full">

                <label for="inv_email" class="w-full">Your Email:</label>
                <input type="email" id="inv_email" placeholder="Your Email" required class="w-full">

                <label for="inv_mobile" class="w-full">Mobile Number:</label>
                <input type="tel" id="inv_mobile" placeholder="Mobile Number" required class="w-full">

                <label for="inv_amount" class="w-full">Investment Amount (₹):</label>
                <input type="number" id="inv_amount" placeholder="Investment Amount (₹)" min="500" step="100" required class="w-full">
                <p class="text-sm text-gray-700 text-left w-full mt-1" id="invAmountValidationMessage">Minimum ₹500, in multiples of ₹100. Maximum ₹10,000.</p>

                <label for="paidUpiId" class="w-full">Which UPI ID did you pay to?</label>
                <select id="paidUpiId" required class="w-full">
                    <option value="">Select UPI ID</option>
                    <option value="chowdhurybarnadip98-1@okicici">chowdhurybarnadip98-1@okicici</option>
                    <option value="subhabubai1234-5@okicici">subhabubai1234-5@okicici</option>
                </select>
                
                <label for="inv_utr_number" class="w-full">UTR Number (Mandatory):</label>
                <input type="text" id="inv_utr_number" placeholder="Enter UTR/Transaction Number" required class="w-full">

                <label for="inv_bank_account_name" class="w-full">Bank Account Name:</label>
                <input type="text" id="inv_bank_account_name" placeholder="Name on Bank Account" required class="w-full">

                <label for="inv_bank_account" class="w-full">Bank Account Number:</label>
                <input type="text" id="inv_bank_account" placeholder="Bank Account Number" required class="w-full">

                <label for="inv_ifsc_code" class="w-full">IFSC Code:</label>
                <input type="text" id="inv_ifsc_code" placeholder="IFSC Code" required class="w-full">

                <label for="inv_upi_id_optional" class="w-full">Your UPI ID (Optional):</label>
                <input type="text" id="inv_upi_id_optional" placeholder="Your UPI ID (Optional)" class="w-full">

                <input type="hidden" id="inv_plan_hidden"> <!-- Hidden field to store selected plan name -->

                <!-- Terms & Conditions Checkbox -->
                <div class="terms-checkbox-group w-full justify-start">
                    <input type="checkbox" id="acceptTerms" class="form-checkbox h-5 w-5 text-blue-600 rounded">
                    <label for="acceptTerms" class="text-base text-gray-700">
                        I accept the <a href="#" id="viewTermsLink" class="terms-link">Terms & Conditions</a>
                    </label>
                </div>


                <div class="flex justify-center space-x-4 mt-6 w-full">
                    <button type="submit" class="w-1/2" id="submitInvestmentBtn">Submit Investment</button>
                    <button type="button" class="w-1/2 cancel-btn" id="cancelInvestFormBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Sign In Modal -->
    <div id="signInModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeSignInModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">Sign In</h2>
            <form id="signInForm" class="flex flex-col items-center">
                <label for="signInEmail" class="w-full">Email:</label>
                <input type="email" id="signInEmail" placeholder="Your Email" required class="w-full">

                <label for="signInPassword" class="w-full">Password:</label>
                <input type="password" id="signInPassword" placeholder="Your Password" required class="w-full">

                <div class="flex justify-center space-x-4 mt-6 w-full">
                    <button type="submit" class="w-1/2" id="signInSubmitBtn">Sign In</button>
                    <button type="button" class="w-1/2 cancel-btn" id="cancelSignInBtn">Cancel</button>
                </div>
                <p class="text-center text-sm text-gray-600 mt-4">
                    Don't have an account? <a href="#" id="switchToSignUp" class="text-blue-500 hover:underline">Sign Up</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signUpModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeSignUpModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">Sign Up</h2>
            <form id="signUpForm" class="flex flex-col items-center">
                <label for="signUpEmail" class="w-full">Email:</label>
                <input type="email" id="signUpEmail" placeholder="Your Email" required class="w-full">

                <label for="signUpPassword" class="w-full">Password:</label>
                <input type="password" id="signUpPassword" placeholder="Create Password" required class="w-full">
                <p class="text-sm text-gray-700 text-left w-full mt-1">Minimum 6 characters.</p>

                <label for="signUpConfirmPassword" class="w-full">Confirm Password:</label>
                <input type="password" id="signUpConfirmPassword" placeholder="Confirm Password" required class="w-full">

                <div class="flex justify-center space-x-4 mt-6 w-full">
                    <button type="submit" class="w-1/2" id="signUpSubmitBtn">Sign Up</button>
                    <button type="button" class="w-1/2 cancel-btn" id="cancelSignUpBtn">Cancel</button>
                </div>
                <p class="text-center text-sm text-gray-600 mt-4">
                    Already have an account? <a href="#" id="switchToSignIn" class="text-blue-500 hover:underline">Sign In</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Custom Message Modal -->
    <div id="messageModal" class="modal-overlay">
        <div class="modal-content text-gray-800 bg-white rounded-3xl p-8 shadow-xl text-center">
            <h3 id="messageModalTitle" class="text-2xl font-bold mb-4"></h3>
            <p id="messageModalText" class="text-lg mb-6"></p>
            <button id="closeMessageModalBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full shadow-md">
                OK
            </button>
        </div>
    </div>

    <!-- My Investments Modal (New) -->
    <div id="myInvestmentsModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeMyInvestmentsModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">My Investments</h2>
            <div id="investments-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Investment summary cards will be dynamically loaded here -->
                <p id="no-investments-message" class="text-center text-lg text-gray-600 col-span-full">
                    You have no investments yet. Start investing today!
                </p>
            </div>
            <p id="current-user-id" class="text-center text-sm text-gray-500 mt-8"></p>
        </div>
    </div>

    <!-- Investment Details Modal (New) -->
    <div id="investmentDetailsModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeInvestmentDetailsModalBtn">&times;</button>
            <h2 id="detailModalPlanName" class="text-3xl font-bold text-blue-700 mb-6 text-center"></h2>
            <div class="investment-details-group space-y-1 mb-6">
                <p>
                    <span class="flex items-center"><span class="mr-2 text-blue-600">💰</span>Invested Amount:</span> <strong id="detailInvestedAmount" class="text-blue-700"></strong>
                </p>
                <p>
                    <span class="flex items-center"><span class="mr-2 text-green-600">📈</span>Monthly Payout:</span> <strong id="detailMonthlyPayout" class="text-green-700"></strong>
                </p>
                <p>
                    <span class="flex items-center"><span class="mr-2 text-green-600">💸</span>Projected Total Return:</span> <strong id="detailProjectedTotalReturn" class="text-green-700"></strong>
                </p>
                <p>
                    <span class="flex items-center"><span class="mr-2 text-red-500">🗓️</span>Invest Date:</span> <strong id="detailInvestDate" class="text-gray-800"></strong>
                </p>
                <p>
                    <span class="flex items-center"><span class="mr-2 text-red-500">🗓️</span>Your Plan End date:</span> <strong id="detailPlanEndDate" class="text-gray-800"></strong>
                </p>
                <p>
                    <span class="flex items-center"><span class="mr-2 text-red-500">🗓️</span>You will get your investment back:</span> <strong id="detailPayoutReturnDate" class="text-gray-800"></strong>
                </p>
            </div>
            <div class="financial-details-group mt-4 pt-4 text-sm space-y-1">
                <p><span>UTR Number:</span> <strong id="detailUtrNumber" class="text-gray-800"></strong></p>
                <p><span>Paid To UPI ID:</span> <strong id="detailPaidUpiId" class="text-gray-800"></strong></p>
                <p><span>Bank Account Name:</span> <strong id="detailBankAccountName" class="text-gray-800"></strong></p>
                <p><span>Bank A/C:</span> <strong id="detailBankAccount" class="text-gray-800"></strong></p>
                <p><span>IFSC:</span> <strong id="detailIfscCode" class="text-gray-800"></strong></p>
                <p id="detailOptionalUpiRow" class="hidden"><span>Your UPI ID:</span> <strong id="detailUpiIdOptional" class="text-gray-800"></strong></p>
            </div>
        </div>
    </div>

    <!-- New: Where Your Money Works Modal -->
    <div id="whereMoneyWorksModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeWhereMoneyWorksModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">Where Your Money Works: Building Your Future, Bit by Bit</h2>
            <div class="grid grid-cols-1 gap-10">
                <div class="bg-indigo-100 rounded-2xl p-8 shadow-md">
                    <div class="text-5xl mb-4 text-center">📈</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-3 text-center">Strategic Investments in Share Market</h3>
                    <p class="text-lg text-gray-700 text-center">A significant portion of your capital is expertly managed in the share market, focusing on diversified portfolios with high-growth potential. We employ rigorous analysis and smart trading strategies to secure substantial returns.</p>
                </div>
                <div class="bg-indigo-100 rounded-2xl p-8 shadow-md">
                    <div class="text-5xl mb-4 text-center">🤝</div>
                    <h3 class="text-2xl font-bold text-blue-700 mb-3 text-center">Secure Lending on Trusted Platforms</h3>
                    <p class="text-lg text-gray-700 text-center">To ensure stable and consistent returns, a portion of your investment is allocated to lending on verified and trusted platforms. This diversifies risk and provides a reliable income stream, ensuring your money is always working for you.</p>
                </div>
            </div>
        </div>
    </div >


    <!-- Terms and Conditions Modal -->
    <div id="termsAndConditionsModal" class="modal-overlay">
        <div class="modal-content text-gray-800">
            <button class="modal-close-btn" id="closeTermsAndConditionsModalBtn">&times;</button>
            <h2 class="text-3xl font-bold text-blue-700 mb-6 text-center">Terms & Conditions</h2>
            <div class="text-sm text-gray-700 space-y-4 max-h-96 overflow-y-auto pr-2">
                <p>Welcome to ADS FUND. By proceeding with any investment through our platform, you acknowledge that you have read, understood, and agree to be bound by the following Terms & Conditions. Please read them carefully.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">1. Acceptance of Terms</h3>
                <p>By clicking "I accept the Terms & Conditions" and submitting your investment, you enter into a binding agreement with ADS FUND. If you do not agree to these terms, you should not proceed with any investment.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">2. Investment Risks</h3>
                <p>Investment in financial products involves inherent risks. While ADS FUND strives to provide consistent returns as outlined in our plans, we cannot guarantee any specific rate of return or the preservation of your principal investment. Market conditions, economic factors, and other unforeseen circumstances can impact investment performance. You acknowledge that you understand these risks and are willing to bear them.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">3. No Financial Advice</h3>
                <p>The information provided on this website and through our communications is for general informational purposes only and does not constitute financial, investment, legal, or tax advice. You are solely responsible for conducting your own due diligence and consulting with qualified professionals before making any investment decisions.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">4. Investment Plans and Returns</h3>
                <p>Details of our investment plans, including monthly returns, minimum investment amounts, payout frequencies, and lock-in periods, are as specified on the "Investment Plans" section of this website. Projected returns and bonuses are based on current market analysis and historical performance, but are not guaranteed.</p>
                <ul class="list-disc list-inside ml-4">
                    <li><strong>Monthly Payouts:</strong> Monthly returns (e.g., 7.5%) are calculated on your principal investment and are typically disbursed at the end of each calendar month.</li>
                    <li><strong>Bonuses:</strong> Additional bonuses for 6-month or 12-month plans are conditional upon the completion of the respective lock-in periods.</li>
                </ul>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">5. Lock-in Periods and Withdrawals</h3>
                <p>Each investment plan has a specified lock-in period. During this period, your principal investment is committed to the fund.</p>
                <ul class="list-disc list-inside ml-4">
                    <li><strong>After Lock-in:</strong> Upon completion of the lock-in period, you may choose to withdraw your principal and any accumulated bonuses, reinvest, or continue receiving monthly returns.</li>
                    <li><strong>Early Withdrawals:</strong> For withdrawals requested before the completion of the stated lock-in period, the principal amount will be returned after a processing period of 15 business days. An early withdrawal penalty equivalent to <strong>two months' projected returns</strong> on the principal amount will be deducted from your principal before disbursement.</li>
                </ul>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">6. KYC and Verification</h3>
                <p>To comply with regulatory requirements and prevent fraud, ADS FUND reserves the right to request Know Your Customer (KYC) documentation and other verification details from investors at any time. Failure to provide requested information may result in delays in processing investments or withdrawals, or the suspension of your account.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">7. Payment and UTR Number</h3>
                <p>All investments must be made through the specified UPI IDs or bank transfer methods provided on our investment form. It is mandatory to provide an accurate UTR (Unique Transaction Reference) or transaction number for all payments. Investments cannot be confirmed or processed without a valid UTR number.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">8. Limitation of Liability</h3>
                <p>ADS FUND, its directors, employees, or affiliates shall not be liable for any direct, indirect, incidental, special, consequential, or punitive damages, including but not limited to, loss of profits, data, or other intangible losses, resulting from:</p>
                <ul class="list-disc list-inside ml-4">
                    <li>Your access to or use of, or inability to access or use, the service;</li>
                    <li>Any conduct or content of any third party on the service;</li>
                    <li>Any content obtained from the service; and</li>
                    <li>Unauthorized access, use, or alteration of your transmissions or content, whether based on warranty, contract, tort (including negligence), or any other legal theory, whether or not we have been informed of the possibility of such damage.</li>
                </ul>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">9. Privacy Policy</h3>
                <p>Your privacy is important to us. Our <a href="#" class="terms-link">Privacy Policy</a>, available on our website, explains how we collect, use, and protect your personal information. By agreeing to these Terms & Conditions, you also agree to our Privacy Policy.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">10. Governing Law and Dispute Resolution</h3>
                <p>These Terms & Conditions shall be governed by and construed in accordance with the laws of India. Any disputes arising out of or in connection with these terms shall be subject to the exclusive jurisdiction of the courts in [Specify City/State, e.g., Mumbai, Maharashtra], India.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">11. Amendments to Terms</h3>
                <p>ADS FUND reserves the right to amend or update these Terms & Conditions at any time without prior notice. It is your responsibility to review these terms periodically for any changes. Your continued use of the service or continued investment after any amendments constitutes your acceptance of the revised terms.</p>

                <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-2">12. Contact Information</h3>
                <p>For any questions regarding these Terms & Conditions, please contact us at <a href="mailto:itsads2k23@gmail.com" class="terms-link">itsads2k23@gmail.com</a>.</p>
            </div>
            <button id="closeTermsContentBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full shadow-md mt-8">
                Close
            </button>
        </div>
    </div>


    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import {
            getAuth,
            signInAnonymously,
            signInWithCustomToken,
            onAuthStateChanged,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import {
            getFirestore,
            collection,
            addDoc,
            query,
            where,
            onSnapshot,
            serverTimestamp,
            orderBy
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Global Firebase variables - declared as `let` so they can be assigned later
        let app;
        let auth;
        let db; // Firestore instance
        let currentUserId = null; // To store the authenticated user's ID
        let currentUserEmail = null; // To store the authenticated user's email
        let selectedPlanDetails = {}; // To store details of the plan chosen by the user
        let appId; // Declare appId globally for Firestore paths
        let userInvestmentsData = []; // Store fetched investments here

        // --- Custom Message Modal Functions ---
        const messageModal = document.getElementById('messageModal');
        const messageModalTitle = document.getElementById('messageModalTitle');
        const messageModalText = document.getElementById('messageModalText');
        const closeMessageModalBtn = document.getElementById('closeMessageModalBtn');

        function showMessage(title, text, isSuccess = true) {
            if (messageModalTitle) messageModalTitle.textContent = title;
            if (messageModalText) messageModalText.textContent = text;
            if (messageModal) {
                if (isSuccess) {
                    messageModalTitle.style.color = '#065f46'; // green-800
                    messageModalText.style.color = '#065f46'; // green-800
                } else {
                    messageModalTitle.style.color = '#991b1b'; // red-800
                    messageModalText.style.color = '#991b1b'; // red-800
                }
                messageModal.classList.add('active');
            }
        }

        function hideMessage() {
            if (messageModal) messageModal.classList.remove('active');
        }

        if (closeMessageModalBtn) {
            closeMessageModalBtn.addEventListener('click', hideMessage);
        }

        if (messageModal) {
            messageModal.addEventListener('click', (e) => {
                if (e.target === messageModal) {
                    hideMessage();
                }
            });
        }

        // --- Modal Control Functions (General) ---
        function openModal(modalElement) {
            modalElement.classList.add('active');
        }

        function closeModal(modalElement) {
            modalElement.classList.remove('active');
        }

        // --- Mobile Menu Toggle and Close ---
        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const mobileMenu = document.getElementById('mobileMenu');
        const closeMobileMenuButton = document.getElementById('closeMobileMenuButton');

        const closeMobileMenu = () => {
            if (mobileMenu) {
                mobileMenu.classList.remove('opacity-100');
                mobileMenu.classList.add('opacity-0');
                // Use transitionend event to hide the menu after the transition completes
                mobileMenu.addEventListener('transitionend', () => {
                    mobileMenu.classList.add('hidden');
                }, { once: true }); // The { once: true } option ensures the listener is removed after it runs once
            }
        };

        if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', () => {
                if (mobileMenu) {
                    mobileMenu.classList.remove('hidden');
                    // Force reflow to ensure the transition starts correctly
                    void mobileMenu.offsetWidth;
                    setTimeout(() => mobileMenu.classList.add('opacity-100'), 10);
                }
            });
        }

        if (closeMobileMenuButton) {
            closeMobileMenuButton.addEventListener('click', closeMobileMenu);
        }
        // Attach closeMobileMenu to all mobile menu links
        document.querySelectorAll('#mobileMenu a[data-close-menu]').forEach(link => {
            link.addEventListener('click', closeMobileMenu);
        });


        // All main script logic moves inside DOMContentLoaded to ensure elements and Firebase are ready
        document.addEventListener('DOMContentLoaded', async () => {
            // --- Element Declarations (ensure they are available here) ---
            const investmentAmountInput = document.getElementById('investmentAmount');
            const investmentPlanSelect = document.getElementById('investmentPlan');
            const calculateBtn = document.getElementById('calculateBtn');
            const resultsDiv = document.getElementById('results');
            const displayInitialInvestment = document.getElementById('displayInitialInvestment');
            const displayTotalReturn = document.getElementById('displayTotalReturn');
            const displayPercentageReturn = document.getElementById('displayPercentageReturn');
            const errorMessageDiv = document.getElementById('errorMessage');
            const countdownElement = document.getElementById('countdown');

            const planDetailModal = document.getElementById('planDetailModal');
            const closePlanDetailModalBtn = document.getElementById('closePlanDetailModalBtn');
            const investNowBtn = document.getElementById('investNowBtn');
            const planCards = document.querySelectorAll('.plan-card');

            const investModal = document.getElementById('investModal');
            // FIX: Corrected the assignment of closeInvestModalBtn
            const closeInvestModalBtn = document.getElementById('closeInvestModalBtn');
            const investmentForm = document.getElementById('investmentForm');
            const invNameInput = document.getElementById('inv_name');
            const invEmailInput = document.getElementById('inv_email');
            const invMobileInput = document.getElementById('inv_mobile');
            const invAmountInput = document.getElementById('inv_amount');
            const invAmountValidationMessage = document.getElementById('invAmountValidationMessage');
            const invUtrNumberInput = document.getElementById('inv_utr_number');
            const paidUpiIdSelect = document.getElementById('paidUpiId'); // New element
            const invBankAccountNameInput = document.getElementById('inv_bank_account_name');
            const invBankAccountInput = document.getElementById('inv_bank_account');
            const invIfscCodeInput = document.getElementById('inv_ifsc_code');
            const invUpiIdOptionalInput = document.getElementById('inv_upi_id_optional');
            const invPlanHiddenInput = document.getElementById('inv_plan_hidden');
            const investFormPlanName = document.getElementById('investFormPlanName');
            const cancelInvestFormBtn = document.getElementById('cancelInvestFormBtn');
            const submitInvestmentBtn = document.getElementById('submitInvestmentBtn'); // Added for loading state

            const explorePlansBtn = document.getElementById('explorePlansBtn');

            const navAuthLinks = document.getElementById('navAuthLinks');
            const mobileNavAuthLinks = document.getElementById('mobileNavAuthLinks');

            const myInvestmentsModal = document.getElementById('myInvestmentsModal');
            const closeMyInvestmentsModalBtn = document.getElementById('closeMyInvestmentsModalBtn');
            const investmentsContainer = document.getElementById('investments-container');
            const noInvestmentsMessage = document.getElementById('no-investments-message');
            const currentUserIdDisplay = document.getElementById('current-user-id');

            const signInModal = document.getElementById('signInModal');
            const signUpModal = document.getElementById('signUpModal');
            const signInForm = document.getElementById('signInForm');
            const signUpForm = document.getElementById('signUpForm');
            const signInEmailInput = document.getElementById('signInEmail');
            const signInPasswordInput = document.getElementById('signInPassword');
            const signUpEmailInput = document.getElementById('signUpEmail');
            const signUpPasswordInput = document.getElementById('signUpPassword');
            const signUpConfirmPasswordInput = document.getElementById('signUpConfirmPassword');
            const switchToSignUpBtn = document.getElementById('switchToSignUp');
            const switchToSignInBtn = document.getElementById('switchToSignIn');
            const cancelSignInBtn = document.getElementById('cancelSignInBtn');
            const cancelSignUpBtn = document.getElementById('cancelSignUpBtn');
            const signInSubmitBtn = document.getElementById('signInSubmitBtn'); // Added for loading state
            const signUpSubmitBtn = document.getElementById('signUpSubmitBtn'); // Added for loading state


            // New Terms & Conditions elements
            const termsAndConditionsModal = document.getElementById('termsAndConditionsModal');
            const closeTermsAndConditionsModalBtn = document.getElementById('closeTermsAndConditionsModalBtn');
            const viewTermsLink = document.getElementById('viewTermsLink');
            const acceptTermsCheckbox = document.getElementById('acceptTerms');
            const closeTermsContentBtn = document.getElementById('closeTermsContentBtn');

            // New Investment Details Modal elements
            const investmentDetailsModal = document.getElementById('investmentDetailsModal');
            const closeInvestmentDetailsModalBtn = document.getElementById('closeInvestmentDetailsModalBtn');
            const detailModalPlanName = document.getElementById('detailModalPlanName');
            const detailInvestedAmount = document.getElementById('detailInvestedAmount');
            const detailMonthlyPayout = document.getElementById('detailMonthlyPayout');
            const detailProjectedTotalReturn = document.getElementById('detailProjectedTotalReturn');
            const detailInvestDate = document.getElementById('detailInvestDate');
            const detailPlanEndDate = document.getElementById('detailPlanEndDate');
            const detailPayoutReturnDate = document.getElementById('detailPayoutReturnDate');
            const detailUtrNumber = document.getElementById('detailUtrNumber');
            const detailPaidUpiId = document.getElementById('detailPaidUpiId');
            const detailBankAccountName = document.getElementById('detailBankAccountName');
            const detailBankAccount = document.getElementById('detailBankAccount');
            const detailIfscCode = document.getElementById('detailIfscCode');
            const detailUpiIdOptional = document.getElementById('detailUpiIdOptional');
            const detailOptionalUpiRow = document.getElementById('detailOptionalUpiRow');

            // Where Your Money Works specific elements (now for the modal)
            const whereMoneyWorksModal = document.getElementById('whereMoneyWorksModal');
            const closeWhereMoneyWorksModalBtn = document.getElementById('closeWhereMoneyWorksModalBtn'); // Corrected assignment
            const whereMoneyWorksDesktopLink = document.getElementById('whereMoneyWorksDesktopLink');
            const whereMoneyWorksMobileLink = document.getElementById('whereMoneyWorksMobileLink');


            // --- Firebase Initialization and Initial Auth Attempt ---
            try {
                appId = 'ownads-07';
                const firebaseConfig = {
                    apiKey: "AIzaSyBFS4IF12Tr4ZN7n-xqHRwf5MM020zddvw",
                    authDomain: "ownads-07.firebaseapp.com",
                    databaseURL: "https://ownads-07-default-rtdb.asia-southeast1.firebasedatabase.app",
                    projectId: "ownads-07",
                    storageBucket: "ownads-07.firebasestorage.app",
                    messagingSenderId: "274286517816",
                    appId: "1:274286517816:web:d83478fdd4119d183d10cd",
                    measurementId: "G-D5K9HCL8KB"
                };

                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // Attempt initial sign-in
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                let userWasLoggedIn = false; // Flag to track if user was logged in (non-anonymous)

                // First, check if a current user already exists (e.g., from a persistent session)
                if (auth.currentUser) {
                    currentUserId = auth.currentUser.uid;
                    currentUserEmail = auth.currentUser.email;
                    userWasLoggedIn = !auth.currentUser.isAnonymous;
                    console.log("Existing Firebase user detected:", currentUserId, "Anonymous:", auth.currentUser.isAnonymous);
                } else {
                    // No current user, try to sign in with custom token or anonymously
                    if (initialAuthToken) {
                        try {
                            const userCredential = await signInWithCustomToken(auth, initialAuthToken);
                            currentUserId = userCredential.user.uid;
                            currentUserEmail = userCredential.user.email;
                            userWasLoggedIn = !userCredential.user.isAnonymous;
                            console.log("Signed in with custom token successfully.");
                        } catch (error) {
                            console.warn("Warning: Error signing in with custom token. Attempting anonymous sign-in:", error.message);
                            try {
                                const userCredential = await signInAnonymously(auth);
                                currentUserId = userCredential.user.uid;
                                currentUserEmail = userCredential.user.email; // Will be null for anonymous
                                userWasLoggedIn = false; // Anonymous user is not considered "logged in" for app features
                                console.log("Signed in anonymously after custom token failure.");
                            } catch (anonError) {
                                console.error("Error signing in anonymously:", anonError.message);
                                showMessage('Authentication Setup Failed', `Failed to sign in. Error: ${anonError.message}. Please ensure Anonymous and Email/Password sign-in methods are enabled in your Firebase project's Authentication settings.`, false);
                                userWasLoggedIn = false; // Ensure logged out state is reflected
                            }
                        }
                    } else {
                        // No initial token, try anonymous sign-in directly
                        try {
                            const userCredential = await signInAnonymously(auth);
                            currentUserId = userCredential.user.uid;
                            currentUserEmail = userCredential.user.email;
                            userWasLoggedIn = false; // Anonymous user is not considered "logged in" for app features
                            console.log("Signed in anonymously (no initial token).");
                        } catch (anonError) {
                            console.error("Error signing in anonymously:", anonError.message);
                            showMessage('Authentication Setup Failed', `Failed to sign in. Error: ${anonError.message}. Please ensure Anonymous and Email/Password sign-in methods are enabled in your Firebase project's Authentication settings.`, false);
                            userWasLoggedIn = false; // Ensure logged out state is reflected
                        }
                    }
                }

                // Immediately update UI based on the result of the initial auth attempt
                updateAuthUI(userWasLoggedIn, currentUserEmail);

                // Setup the real-time auth state listener for future changes
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        console.log("onAuthStateChanged: User state changed.", user.uid, "Email:", user.email, "Anonymous:", user.isAnonymous);
                        currentUserId = user.uid;
                        currentUserEmail = user.email;
                        updateAuthUI(!user.isAnonymous, currentUserEmail);
                    } else {
                        console.log("onAuthStateChanged: User logged out.");
                        currentUserId = null;
                        currentUserEmail = null;
                        updateAuthUI(false);
                        // Clear investments display upon logout
                        if (investmentsContainer) {
                            investmentsContainer.innerHTML = '';
                            investmentsContainer.appendChild(noInvestmentsMessage);
                            noInvestmentsMessage.style.display = 'block';
                        }
                        if (currentUserIdDisplay) currentUserIdDisplay.textContent = '';
                    }
                });

            } catch (error) {
                console.error("Critical Error during Firebase initialization:", error);
                showMessage('Initialization Error', `Failed to initialize Firebase services: ${error.message}. Please ensure your Firebase project's API Key and other configuration are correct, and that Email/Password and Anonymous sign-in methods are enabled in your Firebase Authentication settings.`, false);
                // Ensure UI still shows logged out options even if init fails
                updateAuthUI(false);
            }

            // --- Event Listeners for Modals (moved here to ensure elements exist) ---
            closeSignInModalBtn?.addEventListener('click', () => closeModal(signInModal));
            closeSignUpModalBtn?.addEventListener('click', () => closeModal(signUpModal));
            cancelSignInBtn?.addEventListener('click', () => closeModal(signInModal));
            cancelSignUpBtn?.addEventListener('click', () => closeModal(signUpModal));

            switchToSignUpBtn?.addEventListener('click', (e) => {
                e.preventDefault();
                closeModal(signInModal);
                openModal(signUpModal);
            });
            switchToSignInBtn?.addEventListener('click', (e) => {
                e.preventDefault();
                closeModal(signUpModal);
                openModal(signInModal);
            });

            closeMyInvestmentsModalBtn?.addEventListener('click', () => {
                closeModal(myInvestmentsModal);
            });
            // New: Close Investment Details Modal
            closeInvestmentDetailsModalBtn?.addEventListener('click', () => {
                closeModal(investmentDetailsModal);
            });
            if (investmentDetailsModal) {
                investmentDetailsModal.addEventListener('click', (e) => {
                    if (e.target === investmentDetailsModal) {
                        closeModal(investmentDetailsModal);
                    }
                });
            }

            // New: Terms and Conditions Modal event listeners
            if (viewTermsLink) {
                viewTermsLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    openModal(termsAndConditionsModal);
                });
            }

            if (closeTermsAndConditionsModalBtn) {
                closeTermsAndConditionsModalBtn.addEventListener('click', () => closeModal(termsAndConditionsModal));
            }
             if (closeTermsContentBtn) {
                closeTermsContentBtn.addEventListener('click', () => closeModal(termsAndConditionsModal));
            }
            if (termsAndConditionsModal) {
                termsAndConditionsModal.addEventListener('click', (e) => {
                    if (e.target === termsAndConditionsModal) {
                        closeModal(termsAndConditionsModal);
                    }
                });
            }

            // New: Where Your Money Works Modal event listeners
            if (whereMoneyWorksDesktopLink && whereMoneyWorksModal) {
                whereMoneyWorksDesktopLink.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default anchor jump
                    openModal(whereMoneyWorksModal);
                });
            }
            if (whereMoneyWorksMobileLink && whereMoneyWorksModal) {
                whereMoneyWorksMobileLink.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default anchor jump
                    openModal(whereMoneyWorksModal);
                    closeMobileMenu(); // Close mobile menu after clicking the link
                });
            }

            // FIX: Add event listeners for the close button and overlay of the "Where Your Money Works" modal
            if (closeWhereMoneyWorksModalBtn) {
                closeWhereMoneyWorksModalBtn.addEventListener('click', () => closeModal(whereMoneyWorksModal));
            }
            if (whereMoneyWorksModal) {
                whereMoneyWorksModal.addEventListener('click', (e) => {
                    if (e.target === whereMoneyWorksModal) { // Only close if clicking on the overlay itself
                        closeModal(whereMoneyWorksModal);
                    }
                });
            }


            // Sign Up Form Submission
            signUpForm?.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Disable button and show loading state
                if (signUpSubmitBtn) {
                    signUpSubmitBtn.disabled = true;
                    signUpSubmitBtn.textContent = 'Processing...';
                }

                const email = signUpEmailInput.value;
                const password = signUpPasswordInput.value;
                const confirmPassword = signUpConfirmPasswordInput.value;

                if (password !== confirmPassword) {
                    showMessage('Sign Up Failed', 'Passwords do not match.', false);
                    if (signUpSubmitBtn) {
                        signUpSubmitBtn.disabled = false;
                        signUpSubmitBtn.textContent = 'Sign Up';
                    }
                    return;
                }
                if (password.length < 6) {
                    showMessage('Sign Up Failed', 'Password should be at least 6 characters.', false);
                    if (signUpSubmitBtn) {
                        signUpSubmitBtn.disabled = false;
                        signUpSubmitBtn.textContent = 'Sign Up';
                    }
                    return;
                }

                if (!auth) {
                    showMessage('Sign Up Failed', 'Firebase Authentication is not ready. Please try again.', false);
                    if (signUpSubmitBtn) {
                        signUpSubmitBtn.disabled = false;
                        signUpSubmitBtn.textContent = 'Sign Up';
                    }
                    return;
                }

                try {
                    await createUserWithEmailAndPassword(auth, email, password);
                    showMessage('Sign Up Successful', 'Your account has been created! You are now signed in.', true);
                    closeModal(signUpModal);
                    signUpForm.reset();
                } catch (error) {
                    console.error("Sign Up Error:", error);
                    let errorMessage = error.message;
                    if (error.code === 'auth/operation-not-allowed') {
                        errorMessage = 'Email/Password sign-in is not enabled. Please enable it in your Firebase project\'s Authentication settings (under "Sign-in method").';
                    } else if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'The email address is already in use by another account.';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'The email address is not valid.';
                    }
                    showMessage('Sign Up Failed', errorMessage, false);
                } finally {
                    if (signUpSubmitBtn) {
                        signUpSubmitBtn.disabled = false;
                        signUpSubmitBtn.textContent = 'Sign Up';
                    }
                }
            });

            // Sign In Form Submission
            signInForm?.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Disable button and show loading state
                if (signInSubmitBtn) {
                    signInSubmitBtn.disabled = true;
                    signInSubmitBtn.textContent = 'Processing...';
                }

                const email = signInEmailInput.value;
                const password = signInPasswordInput.value;

                if (!auth) {
                    showMessage('Sign In Failed', 'Firebase Authentication is not ready. Please try again.', false);
                    if (signInSubmitBtn) {
                        signInSubmitBtn.disabled = false;
                        signInSubmitBtn.textContent = 'Sign In';
                    }
                    return;
                }

                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    showMessage('Sign In Successful', 'You are now signed in!', true);
                    closeModal(signInModal);
                    signInForm.reset();
                } catch (error) {
                    console.error("Sign In Error:", error);
                    let errorMessage = error.message;
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/invalid-credential') {
                        errorMessage = 'Invalid email or password.'; // Catch both for a generic "invalid" message
                    } else if (error.code === 'auth/wrong-password') {
                        errorMessage = 'Wrong password.'; // Specific message for wrong password
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'The email address is not valid.';
                    }
                    showMessage('Sign In Failed', errorMessage, false);
                } finally {
                    if (signInSubmitBtn) {
                        signInSubmitBtn.disabled = false;
                        signInSubmitBtn.textContent = 'Sign In';
                    }
                }
            });


            // --- Auth UI Update Function ---
            function updateAuthUI(loggedIn, email = '') {
                const myInvestmentsLink = `<li><button id="myInvestmentsOpenBtn" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 button-effect">My Investments</button></li>`;
                const signOutLink = `<li><button id="signOutBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 button-effect">Sign Out</button></li>`;
                const loggedOutLinks = `
                    <li><button id="signInOpenBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 button-effect">Sign In</button></li>
                    <li><button id="signUpOpenBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 button-effect">Sign Up</button></li>
                `;

                if (navAuthLinks) {
                    navAuthLinks.innerHTML = loggedIn ? `${myInvestmentsLink}${signOutLink}` : loggedOutLinks;
                } else {
                    console.warn("navAuthLinks element not found.");
                }

                if (mobileNavAuthLinks) {
                    mobileNavAuthLinks.innerHTML = loggedIn ? `${myInvestmentsLink}${signOutLink}` : loggedOutLinks;
                } else {
                    console.warn("mobileNavAuthLinks element not found.");
                }

                // Re-attach event listeners after innerHTML update
                // Desktop navigation links
                document.getElementById('signOutBtn')?.addEventListener('click', async () => {
                    try {
                        await signOut(auth);
                        showMessage('Signed Out', 'You have been successfully signed out.', true);
                        closeMobileMenu(); // This call should be safe now due to hoisting
                    } catch (error) {
                        console.error("Sign Out Error:", error);
                        showMessage('Sign Out Failed', error.message, false);
                    }
                });

                document.getElementById('signInOpenBtn')?.addEventListener('click', () => openModal(signInModal));
                document.getElementById('signUpOpenBtn')?.addEventListener('click', () => openModal(signUpModal));

                // My Investments button (desktop)
                document.getElementById('myInvestmentsOpenBtn')?.addEventListener('click', () => {
                    openModal(myInvestmentsModal);
                    closeMobileMenu(); // This call should be safe now due to hoisting
                    fetchInvestments();
                });

                // Mobile menu specific listeners
                document.querySelector('#mobileNavAuthLinks #signOutBtn')?.addEventListener('click', async () => {
                     try {
                        await signOut(auth);
                        showMessage('Signed Out', 'You have been successfully signed out.', true);
                        closeMobileMenu(); // This call should be safe now due to hoisting
                    } catch (error) {
                        console.error("Sign Out Error:", error);
                        showMessage('Sign Out Failed', error.message, false);
                    }
                });
                document.querySelector('#mobileNavAuthLinks #signInOpenBtn')?.addEventListener('click', () => {
                    openModal(signInModal);
                    closeMobileMenu(); // This call should be safe now due to hoisting
                });
                document.querySelector('#mobileNavAuthLinks #signUpOpenBtn')?.addEventListener('click', () => {
                    openModal(signUpModal);
                    closeMobileMenu(); // This call should be safe now due to hoisting
                });
                document.querySelector('#mobileNavAuthLinks #myInvestmentsOpenBtn')?.addEventListener('click', () => {
                    openModal(myInvestmentsModal);
                    closeMobileMenu(); // This call should be safe now due to hoisting
                    fetchInvestments();
                });


                if (loggedIn) {
                    if (currentUserIdDisplay) currentUserIdDisplay.textContent = `Logged in as: ${email || currentUserId}`;
                    if (invNameInput) invNameInput.value = '';
                    if (invEmailInput) invEmailInput.value = email;
                } else {
                    if (currentUserIdDisplay) currentUserIdDisplay.textContent = '';
                    if (invEmailInput) invEmailInput.value = '';
                }
            }


            // --- Fetch and Display Investments ---
            function fetchInvestments() {
                if (!currentUserId || (auth && auth.currentUser && auth.currentUser.isAnonymous) || !db) {
                    console.log("Not a registered user, anonymous, or Firestore is not ready. Cannot fetch investments.");
                    if (investmentsContainer) {
                        investmentsContainer.innerHTML = '';
                        investmentsContainer.appendChild(noInvestmentsMessage);
                        noInvestmentsMessage.textContent = 'Please sign in to view your investments.';
                        noInvestmentsMessage.style.display = 'block';
                    }
                    if (currentUserIdDisplay) currentUserIdDisplay.textContent = '';
                    return;
                }

                if (investmentsContainer) {
                    investmentsContainer.innerHTML = '<p class="text-center text-lg text-gray-600 col-span-full">Loading your investments...</p>';
                    noInvestmentsMessage.style.display = 'none';
                }
                if (currentUserIdDisplay) currentUserIdDisplay.textContent = `User ID: ${currentUserId}`;

                const userInvestmentsRef = collection(db, `artifacts/${appId}/users/${currentUserId}/investments`);
                const q = query(userInvestmentsRef, orderBy("timestamp", "desc"));

                onSnapshot(q, (snapshot) => {
                    userInvestmentsData = []; // Clear previous data
                    if (snapshot.empty) {
                        if (investmentsContainer) {
                            investmentsContainer.innerHTML = '<p class="text-center text-lg text-gray-600 col-span-full">You have no investments yet. Start investing today!</p>';
                        }
                    } else {
                        if (investmentsContainer) investmentsContainer.innerHTML = '';
                        snapshot.forEach((doc) => {
                            const investment = doc.data();
                            const docId = doc.id; // Get the Firestore document ID
                            investment.id = docId; // Add ID to the investment object
                            userInvestmentsData.push(investment); // Store the full investment data

                            const investDate = investment.timestamp && investment.timestamp.toDate ? new Date(investment.timestamp.toDate()) : new Date();
                            const formattedInvestDate = investDate.toLocaleDateString();

                            const card = `
                                <div class="investment-summary-card ${investment.planName === 'Standard Plan' ? 'standard-plan-item' :
                                                                           investment.planName === 'Premium 6-Month Plan' ? 'premium-plan-item' :
                                                                           'elite-plan-item'} clickable-investment-summary" data-id="${docId}">
                                    <div>
                                        <div class="plan-name">${investment.planName}</div>
                                        <div class="invest-date">Invested on: ${formattedInvestDate}</div>
                                    </div>
                                    <div class="arrow-icon">▶</div>
                                </div>
                            `;
                            if (investmentsContainer) investmentsContainer.insertAdjacentHTML('beforeend', card);
                        });
                        // Attach click listeners to the newly created summary cards
                        document.querySelectorAll('.clickable-investment-summary').forEach(card => {
                            card.addEventListener('click', (event) => {
                                const id = event.currentTarget.dataset.id;
                                showInvestmentDetail(id);
                            });
                        });
                    }
                }, (error) => {
                    console.error("Error fetching investments:", error);
                    if (investmentsContainer) investmentsContainer.innerHTML = '<p class="text-center text-red-500 col-span-full">Error loading investments. Please try again later.</p>';
                });
            }

            // --- Function to display individual investment details ---
            function showInvestmentDetail(id) {
                const investment = userInvestmentsData.find(inv => inv.id === id);

                if (!investment) {
                    showMessage('Error', 'Investment details not found.', false);
                    return;
                }

                console.log("Investment object from Firestore:", investment);
                console.log("investment.monthlyReturn (raw):", investment.monthlyReturn);

                let monthlyReturnRate;
                let monthlyReturnStrFromFirestore = typeof investment.monthlyReturn === 'string' ? investment.monthlyReturn : '';

                if (monthlyReturnStrFromFirestore) {
                    monthlyReturnRate = parseFloat(monthlyReturnStrFromFirestore.replace('%', '')) / 100;
                }

                // Fallback: If monthlyReturn is missing or parsed to 0 from Firestore,
                // try to get it from the planCards data attributes using the planName
                if (isNaN(monthlyReturnRate) || monthlyReturnRate === 0) {
                    const correspondingPlanCard = Array.from(planCards).find(card =>
                        card.dataset.planName === investment.planName
                    );
                    if (correspondingPlanCard) {
                        const rateFromCard = parseFloat(correspondingPlanCard.dataset.monthlyReturn.replace('%', '')) / 100;
                        if (!isNaN(rateFromCard) && rateFromCard > 0) {
                            monthlyReturnRate = rateFromCard;
                            console.log(`Monthly return rate fallback: Used value from plan card (${monthlyReturnRate}) for plan ${investment.planName}`);
                        } else {
                            // If even fallback fails, default to 0 to prevent NaN calculations
                            monthlyReturnRate = 0;
                            console.warn(`Fallback for monthly return rate failed for plan ${investment.planName}. Defaulting to 0.`);
                        }
                    } else {
                        monthlyReturnRate = 0;
                        console.warn(`No corresponding plan card found for ${investment.planName}. Monthly payout will be 0.`);
                    }
                }

                console.log("monthlyReturnRate (after fallback check):", monthlyReturnRate);
                console.log("Type of monthlyReturnRate:", typeof monthlyReturnRate);

                let lockInMonths = 0;
                let totalProjectedReturn = 0;
                // Ensure investment.amount is treated as a number for calculation
                let monthlyPayout = parseFloat(investment.amount) * monthlyReturnRate;
                console.log("investment.amount:", investment.amount);
                console.log("Type of investment.amount:", typeof investment.amount);
                console.log("monthlyPayout (calculated):", monthlyPayout);


                if (investment.planName === "Standard Plan") {
                    lockInMonths = 2;
                } else if (investment.planName === "Premium 6-Month Plan") {
                    lockInMonths = 6;
                }
                // Removed redundant "else if (investment.planName === "Elite 12-Month Plan")" for clarity, as lockInMonths is 12 by default for Elite
                else if (investment.planName === "Elite 12-Month Plan") {
                    lockInMonths = 12;
                }


                // Re-calculate total projected return based on the (potentially corrected) monthlyReturnRate
                // and the bonus applicable for the plan.
                if (investment.planName === "Standard Plan") {
                    totalProjectedReturn = parseFloat(investment.amount) * (1 + (monthlyReturnRate * lockInMonths));
                } else if (investment.planName === "Premium 6-Month Plan") {
                    const premiumBonus = 0.045; // Base 4.5% bonus for Premium plan
                    totalProjectedReturn = parseFloat(investment.amount) * (1 + (monthlyReturnRate * lockInMonths) + premiumBonus);
                } else if (investment.planName === "Elite 12-Month Plan") {
                    const eliteBonus = 0.10; // Base 10% bonus for Elite plan
                    totalProjectedReturn = parseFloat(investment.amount) * (1 + (monthlyReturnRate * lockInMonths) + eliteBonus);
                }


                const investDate = investment.timestamp && investment.timestamp.toDate ? new Date(investment.timestamp.toDate()) : new Date();
                const formattedInvestDate = investDate.toLocaleDateString();

                const planEndDate = new Date(investDate);
                planEndDate.setMonth(planEndDate.getMonth() + lockInMonths);
                const formattedPlanEndDate = planEndDate.toLocaleDateString();

                const payoutReturnDate = new Date(planEndDate.getFullYear(), planEndDate.getMonth() + 1, 0); // Last day of the plan end month
                const formattedPayoutReturnDate = payoutReturnDate.toLocaleDateString();

                // Populate the new modal
                detailModalPlanName.textContent = investment.planName;
                detailInvestedAmount.textContent = `₹${parseFloat(investment.amount).toFixed(2)}`;
                detailMonthlyPayout.textContent = `₹${monthlyPayout.toFixed(2)}`;
                detailProjectedTotalReturn.textContent = `₹${totalProjectedReturn.toFixed(2)}`;
                detailInvestDate.textContent = formattedInvestDate;
                detailPlanEndDate.textContent = formattedPlanEndDate;
                detailPayoutReturnDate.textContent = formattedPayoutReturnDate;
                detailUtrNumber.textContent = investment.utrNumber;
                detailPaidUpiId.textContent = investment.paidUpiId || 'N/A';
                detailBankAccountName.textContent = investment.bankAccountName;
                detailBankAccount.textContent = investment.bankAccount;
                detailIfscCode.textContent = investment.ifscCode;

                if (investment.upiIdOptional) {
                    detailUpiIdOptional.textContent = investment.upiIdOptional;
                    detailOptionalUpiRow.classList.remove('hidden');
                } else {
                    detailUpiIdOptional.textContent = '';
                    detailOptionalUpiRow.classList.add('hidden');
                }

                closeModal(myInvestmentsModal); // Close the summary modal
                openModal(investmentDetailsModal); // Open the details modal
            }


            // --- Section Reveal Animation Logic ---
            // Filter out 'where-money-works' from sections to be animated by scroll, as it's now a modal
            const sectionsToAnimate = document.querySelectorAll('section:not(#hero):not(.modal-overlay):not(#where-money-works)');

            const isInViewport = (element) => {
                const rect = element.getBoundingClientRect();
                return (
                    rect.top < (window.innerHeight || document.documentElement.clientHeight) * 0.8 &&
                    rect.bottom > 0
                );
            };

            const revealSections = () => {
                sectionsToAnimate.forEach(section => {
                    if (isInViewport(section)) {
                        section.classList.remove('section-hidden');
                        section.classList.add('section-visible');
                    }
                });
            };

            sectionsToAnimate.forEach(section => {
                section.classList.add('section-hidden');
            });

            revealSections();
            window.addEventListener('scroll', revealSections);

            // --- Where Your Money Works - Click to Reveal Logic (now opens a modal) ---
            if (whereMoneyWorksDesktopLink && whereMoneyWorksModal) {
                whereMoneyWorksDesktopLink.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default anchor jump
                    openModal(whereMoneyWorksModal);
                });
            }
            if (whereMoneyWorksMobileLink && whereMoneyWorksModal) {
                whereMoneyWorksMobileLink.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default anchor jump
                    openModal(whereMoneyWorksModal);
                    closeMobileMenu(); // Close mobile menu after clicking the link
                });
            }


            // --- Countdown Timer Logic (1st day of next month) ---
            const updateCountdown = () => {
                const now = new Date();
                let nextMonth = now.getMonth() + 1;
                let year = now.getFullYear();
                if (nextMonth === 12) {
                    nextMonth = 0;
                    year++;
                }
                const offerEndDate = new Date(year, nextMonth, 1);

                const totalSeconds = (offerEndDate - now) / 1000;

                if (totalSeconds < 0) {
                    if (countdownElement) countdownElement.textContent = "Offer Expired!";
                    return;
                }

                const days = Math.floor(totalSeconds / (3600 * 24));
                const hours = Math.floor((totalSeconds % (3600 * 24)) / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = Math.floor(totalSeconds % 60);

                if (countdownElement) countdownElement.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            };

            setInterval(updateCountdown, 1000);
            updateCountdown();


            // --- Investment Calculator Logic ---
            calculateBtn.addEventListener('click', async () => {
                const amount = parseFloat(investmentAmountInput.value);
                const plan = investmentPlanSelect.value;
                let monthlyReturnRate = 0;
                let lockInMonths = 0;
                let planName = "";
                let bonusPercentage = 0;
                let currentPlanTotalReturnDisplayed = 0; // To store the original total-return from the card

                // Find the selected plan card to get its data-attributes
                let selectedPlanCard = null;
                for (let i = 0; i < planCards.length; i++) {
                    if (planCards[i].dataset.planName.toLowerCase().includes(plan)) {
                        selectedPlanCard = planCards[i];
                        break;
                    }
                }

                if (!selectedPlanCard) {
                    console.error("Selected plan card not found for calculation.");
                    showMessage('Calculation Error', 'Could not find details for the selected plan.', false);
                    return;
                }

                monthlyReturnRate = parseFloat(selectedPlanCard.dataset.monthlyReturn.replace('%', '')) / 100;
                currentPlanTotalReturnDisplayed = parseFloat(selectedPlanCard.dataset.totalReturn.replace('%', '')); // For display purposes
                // The dataset.totalReturn from HTML is a percentage, convert it
                currentPlanTotalReturnDisplayed = amount * (currentPlanTotalReturnDisplayed / 100);


                if (isNaN(amount) || amount <= 0) {
                    if (resultsDiv) resultsDiv.classList.remove('hidden');
                    if (displayInitialInvestment) displayInitialInvestment.textContent = `Invalid amount.`;
                    if (displayTotalReturn) displayTotalReturn.textContent = `Invalid amount.`;
                    if (displayPercentageReturn) displayPercentageReturn.textContent = `Invalid amount.`;
                    return;
                }

                // Add max investment validation for calculator as well
                const MAX_INVESTMENT_AMOUNT_CALCULATOR = 10000;
                if (amount > MAX_INVESTMENT_AMOUNT_CALCULATOR) {
                    if (resultsDiv) resultsDiv.classList.remove('hidden');
                    if (displayInitialInvestment) displayInitialInvestment.textContent = `₹${amount.toFixed(2)}`;
                    if (displayTotalReturn) displayTotalReturn.textContent = 'N/A';
                    if (displayPercentageReturn) displayPercentageReturn.textContent = 'N/A';
                    showMessage('Investment Limit', `Investment amount cannot exceed ₹${MAX_INVESTMENT_AMOUNT_CALCULATOR}.`, false);
                    return;
                }


                let calculatedTotalReturn = 0;
                if (plan === 'standard') {
                    lockInMonths = 2;
                    calculatedTotalReturn = amount * (1 + (monthlyReturnRate * lockInMonths));
                    planName = "Standard Plan";
                } else if (plan === 'premium') {
                    lockInMonths = 6;
                    const now = new Date();
                    let nextMonth = now.getMonth() + 1;
                    let year = now.getFullYear();
                    if (nextMonth === 12) {
                        nextMonth = 0;
                        year++;
                    }
                    const offerEndDate = new Date(year, nextMonth, 1);

                    // Note: The problem description implies a fixed monthly rate for premium/elite,
                    // and then a bonus. I'll re-calculate total return based on monthlyRate * months + bonus.
                    // The bonus here is an an additional percentage ON TOP of the monthly accumulated return.
                    if (now < offerEndDate) {
                        bonusPercentage = 0.07; // 4.5% + 2.5% special offer
                    } else {
                        bonusPercentage = 0.045; // Base 4.5% bonus
                    }
                    calculatedTotalReturn = amount * (1 + (monthlyReturnRate * lockInMonths) + bonusPercentage);
                    planName = "Premium 6-Month Plan";
                } else if (plan === 'elite') {
                    lockInMonths = 12;
                    bonusPercentage = 0.10; // Elite 10% bonus
                    calculatedTotalReturn = amount * (1 + (monthlyReturnRate * lockInMonths) + bonusPercentage);
                    planName = "Elite 12-Month Plan";
                    if (amount < 1000) {
                         if (resultsDiv) resultsDiv.classList.remove('hidden');
                         if (displayInitialInvestment) displayInitialInvestment.textContent = `₹${amount.toFixed(2)}`;
                         if (displayTotalReturn) displayTotalReturn.textContent = 'N/A';
                         if (displayPercentageReturn) displayPercentageReturn.textContent = 'N/A';
                         showMessage('Minimum Investment', 'The Elite 12-Month Plan requires a minimum investment of ₹1000.', false);
                         return;
                    }
                }

                // If the HTML data-total-return is meant to be the final projected return, use that for display
                // Otherwise, use the calculated totalReturn. For consistency, let's recalculate fully.
                const percentageReturn = ((calculatedTotalReturn - amount) / amount) * 100;


                if (displayInitialInvestment) displayInitialInvestment.textContent = `₹${amount.toFixed(2)}`;
                if (displayTotalReturn) displayTotalReturn.textContent = `₹${calculatedTotalReturn.toFixed(2)}`;
                if (displayPercentageReturn) displayPercentageReturn.textContent = `${percentageReturn.toFixed(2)}%`;
                if (resultsDiv) resultsDiv.classList.remove('hidden');
            });

            // --- Plan Detail Modal Functionality ---
            planCards.forEach(card => {
                card.addEventListener('click', () => {
                    const planName = card.dataset.planName;
                    const monthlyReturn = card.dataset.monthlyReturn;
                    const minInvestment = parseFloat(card.dataset.minInvestment);
                    const payoutFrequency = card.dataset.payoutFrequency;
                    const lockIn = card.dataset.lockIn;
                    const benefitsRaw = card.dataset.benefits;
                    const totalReturn = card.dataset.totalReturn; // Correctly accessing camelCase

                    selectedPlanDetails = {
                        planName: planName,
                        monthlyReturn: monthlyReturn, // Store as string "X.X%"
                        minInvestment: minInvestment,
                        payoutFrequency: payoutFrequency,
                        lockIn: lockIn,
                        benefits: benefitsRaw,
                        totalReturn: totalReturn // Store as string "X.X% over Y months"
                    };

                    if (document.getElementById('modalPlanName')) document.getElementById('modalPlanName').textContent = planName;
                    if (document.getElementById('modalMonthlyReturn')) document.getElementById('modalMonthlyReturn').textContent = monthlyReturn;
                    if (document.getElementById('modalMinInvestment')) document.getElementById('modalMinInvestment').textContent = minInvestment.toFixed(2);
                    if (document.getElementById('modalPayoutFrequency')) document.getElementById('modalPayoutFrequency').textContent = payoutFrequency;
                    if (document.getElementById('modalLockIn')) document.getElementById('modalLockIn').textContent = lockIn;
                    if (document.getElementById('modalTotalReturn')) document.getElementById('modalTotalReturn').textContent = totalReturn;

                    const benefitsList = document.getElementById('modalBenefits');
                    if (benefitsList) {
                        benefitsList.innerHTML = '';
                        try {
                            const benefits = JSON.parse(benefitsRaw);
                            const specialOffers = benefits.filter(benefit => benefit.includes("Bonus:") || benefit.includes("Total Return:"));
                            const exclusivePerks = benefits.filter(benefit => !benefit.includes("Bonus:") && !benefit.includes("Total Return:"));

                            if (specialOffers.length > 0) {
                                const h4Offer = document.createElement('h4');
                                h4Offer.className = 'text-xl font-semibold text-gray-700 mb-2 mt-4';
                                h4Offer.textContent = 'SPECIAL OFFER:';
                                benefitsList.appendChild(h4Offer);
                                specialOffers.forEach(benefit => {
                                    const li = document.createElement('li');
                                    li.textContent = benefit;
                                    benefitsList.appendChild(li);
                                });
                            }

                            if (exclusivePerks.length > 0) {
                                const h4Perks = document.createElement('h4');
                                h4Perks.className = 'text-xl font-semibold text-gray-700 mb-2 mt-4';
                                h4Perks.textContent = 'Exclusive Perks:';
                                benefitsList.appendChild(h4Perks);
                                exclusivePerks.forEach(benefit => {
                                    const li = document.createElement('li');
                                    li.textContent = benefit;
                                    benefitsList.appendChild(li);
                                });
                            }
                            if (specialOffers.length === 0 && exclusivePerks.length === 0 && benefits.length > 0) {
                                const h4Benefits = document.createElement('h4');
                                h4Benefits.className = 'text-xl font-semibold text-gray-700 mb-2';
                                h4Benefits.textContent = 'Benefits:';
                                benefitsList.appendChild(h4Benefits);
                                benefits.forEach(benefit => {
                                    const li = document.createElement('li');
                                    li.textContent = benefit;
                                    benefitsList.appendChild(li);
                                });
                            }
                        } catch (e) {
                            console.error("Error parsing benefits:", e);
                            const li = document.createElement('li');
                            li.textContent = "Benefits information unavailable.";
                            benefitsList.appendChild(li);
                        }
                    }

                    openModal(planDetailModal);
                });
            });

            if (closePlanDetailModalBtn) {
                closePlanDetailModalBtn.addEventListener('click', () => {
                    closeModal(planDetailModal);
                });
            }

            if (planDetailModal) {
                planDetailModal.addEventListener('click', (e) => {
                    if (e.target === planDetailModal) {
                        closeModal(planDetailModal);
                    }
                });
            }


            // --- Invest Now Button (from Plan Detail Modal) now opens the Invest Form Modal ---
            if (investNowBtn) {
                investNowBtn.addEventListener('click', () => {
                    if (!currentUserId || (auth && auth.currentUser && auth.currentUser.isAnonymous)) {
                        showMessage('Authentication Required', 'Please sign in or sign up to invest. Anonymous users cannot submit investments.', false);
                        closeModal(planDetailModal);
                        openModal(signInModal);
                        return;
                    }
                    closeModal(planDetailModal);
                    openModal(investModal);
                    if (investFormPlanName) investFormPlanName.textContent = selectedPlanDetails.planName;
                    if (invPlanHiddenInput) invPlanHiddenInput.value = selectedPlanDetails.planName;
                    if (invAmountInput) {
                        invAmountInput.value = selectedPlanDetails.minInvestment;
                        invAmountInput.min = selectedPlanDetails.minInvestment;
                        // Update validation message for max limit too
                        if (invAmountValidationMessage) {
                             invAmountValidationMessage.textContent = `Minimum ₹${selectedPlanDetails.minInvestment}, in multiples of ₹100. Maximum ₹10,000.`;
                        }
                    }
                    if (invEmailInput && currentUserEmail) invEmailInput.value = currentUserEmail;
                });
            }

            // --- Copy UPI ID functionality ---
            document.querySelectorAll('.copy-upi-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const upiIdToCopy = e.target.dataset.upi;
                    const tempInput = document.createElement('input');
                    document.body.appendChild(tempInput);
                    tempInput.value = upiIdToCopy;
                    tempInput.select();
                    try {
                        document.execCommand('copy');
                        showMessage('Copied!', 'UPI ID copied to clipboard.', true);
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                        showMessage('Copy Failed', 'Could not copy UPI ID. Please copy it manually.', false);
                    }
                    document.body.removeChild(tempInput);
                });
            });

            // --- Investment Form Modal Logic ---
            closeInvestModalBtn?.addEventListener('click', () => closeModal(investModal));
            cancelInvestFormBtn?.addEventListener('click', () => closeModal(investModal));

            investmentForm?.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Check if terms are accepted
                if (!acceptTermsCheckbox || !acceptTermsCheckbox.checked) {
                    showMessage('Agreement Required', 'You must accept the Terms & Conditions to proceed with your investment.', false);
                    return;
                }

                // Disable button and show loading state
                if (submitInvestmentBtn) {
                    submitInvestmentBtn.disabled = true;
                    submitInvestmentBtn.textContent = 'Processing...';
                }

                const name = invNameInput.value.trim();
                const email = invEmailInput.value.trim();
                const mobile = invMobileInput.value.trim();
                const amount = parseFloat(invAmountInput.value);
                const paidUpiId = paidUpiIdSelect.value; // Get the selected UPI ID
                const utrNumber = invUtrNumberInput.value.trim();
                const bankAccountName = invBankAccountNameInput.value.trim();
                const bankAccount = invBankAccountInput.value.trim();
                const ifscCode = invIfscCodeInput.value.trim();
                const upiIdOptional = invUpiIdOptionalInput.value.trim();
                const planName = invPlanHiddenInput.value.trim();

                if (!name || !email || !mobile || !utrNumber || !bankAccountName || !bankAccount || !ifscCode || !planName || isNaN(amount) || !paidUpiId) {
                    showMessage('Missing Information', 'Please fill in all required fields and ensure investment amount is valid.', false);
                    if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                    return;
                }

                // New UTR validation (12 digits)
                if (!/^\d{12}$/.test(utrNumber)) {
                    showMessage('Invalid UTR Number', 'UTR Number must be exactly 12 digits.', false);
                    if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                    return;
                }

                // Minimum investment validation based on selected plan
                if (amount < selectedPlanDetails.minInvestment || (amount % 100 !== 0)) {
                    showMessage('Invalid Amount', `Investment amount must be at least ₹${selectedPlanDetails.minInvestment} and in multiples of ₹100.`, false);
                    if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                    return;
                }

                // New: Maximum investment validation
                const MAX_INVESTMENT_AMOUNT = 10000;
                if (amount > MAX_INVESTMENT_AMOUNT) {
                    showMessage('Investment Limit Exceeded', `Investment amount cannot exceed ₹${MAX_INVESTMENT_AMOUNT}.`, false);
                    if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                    return;
                }

                if (!currentUserId || (auth && auth.currentUser && auth.currentUser.isAnonymous)) {
                     showMessage('Authentication Error', 'You must be signed in with a registered account to submit an investment, and Firebase services must be ready.', false);
                     if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                     return;
                }

                try {
                    const userInvestmentsCollectionRef = collection(db, `artifacts/${appId}/users/${currentUserId}/investments`);
                    await addDoc(userInvestmentsCollectionRef, {
                        userId: currentUserId,
                        name: name,
                        email: email,
                        mobile: mobile,
                        amount: amount,
                        planName: planName,
                        monthlyReturn: selectedPlanDetails.monthlyReturn, // Save the actual monthly return %
                        paidUpiId: paidUpiId, // Store the selected UPI ID
                        utrNumber: utrNumber,
                        bankAccountName: bankAccountName,
                        bankAccount: bankAccount,
                        ifscCode: ifscCode,
                        upiIdOptional: upiIdOptional || null,
                        timestamp: serverTimestamp()
                    });

                    showMessage('Investment Submitted!', `Your investment in the ${planName} of ₹${amount.toFixed(2)} has been recorded. We will verify the UTR number shortly.`, true);
                    closeModal(investModal);
                    investmentForm.reset();
                    // Uncheck terms after successful submission
                    if (acceptTermsCheckbox) acceptTermsCheckbox.checked = false;
                }
                catch (error) {
                    console.error("Error submitting investment:", error);
                    showMessage('Submission Failed', `An error occurred: ${error.message}`, false);
                } finally {
                    if (submitInvestmentBtn) {
                        submitInvestmentBtn.disabled = false;
                        submitInvestmentBtn.textContent = 'Submit Investment';
                    }
                }
            });


            // --- Event listener for "Explore Our Plans" button ---
            if (explorePlansBtn) {
                explorePlansBtn.addEventListener('click', (event) => {
                    event.preventDefault();

                    const plansSection = document.getElementById('plans');
                    if (plansSection) {
                        plansSection.scrollIntoView({ behavior: 'smooth' });

                        setTimeout(() => {
                            planCards.forEach((card, index) => {
                                card.classList.remove('animate-card-pop');
                                void card.offsetWidth;
                                setTimeout(() => {
                                    card.classList.add('animate-card-pop');
                                }, index * 100);
                            });
                        }, 800);
                    }
                });
            }
        });
    </script>
</body>
</html>
